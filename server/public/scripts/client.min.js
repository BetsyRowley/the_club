var myApp=angular.module("myApp",["ngRoute","ngSanitize","ui.bootstrap"]);myApp.config(["$routeProvider","$locationProvider",function(a,b){b.hashPrefix(""),a.when("/home",{templateUrl:"/views/templates/home.html",controller:"LoginController",controllerAs:"login"}).when("/register",{templateUrl:"/views/templates/register.html",controller:"LoginController",controllerAs:"login"}).when("/dashboard",{templateUrl:"/views/templates/dashboard.html",controller:"DashboardController",controllerAs:"dashboard",resolve:{getuser:["ClubService",function(a){return a.getuser()}]}}).when("/spotlight",{templateUrl:"/views/templates/spotlight.html",controller:"SpotlightController",controllerAs:"spotlight",resolve:{getuser:["ClubService",function(a){return a.getuser()}]}}).when("/archive",{templateUrl:"/views/templates/archive.html",controller:"ArchiveController",controllerAs:"archive",resolve:{getuser:["ClubService",function(a){return a.getuser()}]}}).when("/nightstand",{templateUrl:"/views/templates/nightstand.html",controller:"DashboardController",controllerAs:"dashboard",resolve:{getuser:["ClubService",function(a){return a.getuser()}]}}).when("/search",{templateUrl:"/views/templates/search.html",controller:"SearchController",controllerAs:"search",resolve:{getuser:["ClubService",function(a){return a.getuser()}]}}).otherwise({redirectTo:"home"})}]),myApp.controller("ArchiveController",["$http","$location","ClubService",function(a,b,c){var d=this;d.userObject=c.userObject,d.allBooks={},d.getArchive=function(){a.get("/archive").then(function(a){d.allBooks.array=a.data})}}]),myApp.controller("DashboardController",["$http","$location","ClubService",function(a,b,c){var d=this;d.userObject=c.userObject,d.message={},d.allMessages={},d.getMessages=function(){a.get("/messages").then(function(a){d.allMessages.array=a.data})},d.postMessage=function(){d.message.memberId=d.userObject.id,a.post("/messages",d.message).then(function(a){d.message={},d.getMessages()})}}]),myApp.controller("LoginController",["$http","$location","ClubService",function(a,b,c){var d=this;d.user={username:"",password:"",first:"",last:""},d.message="",d.login=function(){""===d.user.username||""===d.user.password?d.message="Enter your username and password!":a.post("/",d.user).then(function(a){a.data.username?b.path("/dashboard"):d.message="Either your email or password were incorrect, please try again!"})},d.registerUser=function(){""===d.user.username||""===d.user.password||""===d.user.first||""===d.user.last?d.message="Please complete all fields!":a.post("/register",d.user).then(function(a){b.path("/home")},function(a){d.message="Please try again."})}}]),myApp.controller("NavController",["$http","$location","ClubService",function(a,b,c){var d=this;d.userObject=c.userObject,d.logout=c.logout}]),myApp.controller("SearchController",["$http","$location","ClubService",function(a,b,c){var d=this;d.userObject=c.userObject,d.book="",d.bookResults={},d.findBook=function(b){a.get("/search/"+b).then(function(a){d.bookResults.array=angular.copy(a.data.docs),d.book=""})},d.addToSpotlight=function(c){a.post("/spotlights",c).then(function(a){b.path("/spotlight")})},d.addToNightStand=function(c){a.post("/nightstand",c).then(function(a){b.path("/nightstand")})}}]),myApp.controller("SpotlightController",["$http","$location","ClubService",function(a,b,c){var d=this;d.feature={},d.activeResults={},d.editing=!1,d.userObject=c.userObject,d.getSpotlight=function(){a.get("/spotlights").then(function(a){d.activeResults.array=a.data})},d.deleteSpotlight=function(b){var c=b.FeaturedBookID;a.delete("/spotlights/"+c).then(function(a){d.getSpotlight()})},d.showEditForm=function(a){d.editing=!0,d.feature.book=angular.copy(a)},d.cancelEdit=function(){d.editing=!1},d.editSpotlight=function(){var b=d.feature.book;a.put("/spotlights",b).then(function(a){d.getSpotlight(),d.editing=!1})}}]),myApp.factory("ClubService",["$http","$location",function(a,b){var c={};return{userObject:c,getuser:function(){a.get("/user").then(function(a){a.data.username?(c.userName=a.data.username,c.first=a.data.first,c.id=a.data.id,c.image=a.data.image):b.path("/home")})},logout:function(){a.get("/user/logout").then(function(a){b.path("/home")})}}}]);